<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<link rel="icon" href="/assets/images/logo.png">

<title>Polyglotbot: A 7 DoF Robot Arm that Writes Translated Text and Speech | Henry Buron</title>

<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Polyglotbot: A 7 DoF Robot Arm that Writes Translated Text and Speech | Henry’s Portfolio</title>
<meta name="generator" content="Jekyll v3.9.2" />
<meta property="og:title" content="Polyglotbot: A 7 DoF Robot Arm that Writes Translated Text and Speech" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="ROS2, Python, MoveIt2, Motion Planning" />
<meta property="og:description" content="ROS2, Python, MoveIt2, Motion Planning" />
<link rel="canonical" href="http://localhost:4000/polyglotbot/" />
<meta property="og:url" content="http://localhost:4000/polyglotbot/" />
<meta property="og:site_name" content="Henry’s Portfolio" />
<meta property="og:image" content="http://localhost:4000/assets/gifs/polyglotbot.GIF" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-12-05T00:00:00-08:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/assets/gifs/polyglotbot.GIF" />
<meta property="twitter:title" content="Polyglotbot: A 7 DoF Robot Arm that Writes Translated Text and Speech" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-12-05T00:00:00-08:00","datePublished":"2023-12-05T00:00:00-08:00","description":"ROS2, Python, MoveIt2, Motion Planning","headline":"Polyglotbot: A 7 DoF Robot Arm that Writes Translated Text and Speech","image":"http://localhost:4000/assets/gifs/polyglotbot.GIF","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/polyglotbot/"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/images/logo.png"}},"url":"http://localhost:4000/polyglotbot/"}</script>
<!-- End Jekyll SEO tag -->


<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    
<link href="/assets/css/screen.css" rel="stylesheet">

<link href="/assets/css/main.css" rel="stylesheet">

<script src="/assets/js/jquery.min.js"></script>

</head>




<body class="layout-post">
	<!-- defer loading of font and font awesome -->
	<noscript id="deferred-styles">
		<link href="https://fonts.googleapis.com/css?family=Righteous%7CMerriweather:300,300i,400,400i,700,700i" rel="stylesheet">
		<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
	</noscript>


<!-- Begin Menu Navigation
================================================== -->
<nav class="navbar navbar-expand-lg navbar-light bg-white fixed-top mediumnavigation nav-down">

    <div class="container pr-0">

    <!-- Begin Logo -->
    <a class="navbar-brand" href="/">
    <img src="/assets/images/logo.png" alt="Henry Buron">
    </a>
    <!-- End Logo -->

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarMediumish" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarMediumish">

        <!-- Begin Menu -->
        <ul class="navbar-nav ml-auto">
            <li class="nav-item ">
                <a class="nav-link" href="/index.html" style="font-size: 24px; font-weight: bold;">Home</a>
            </li>
            <li class="nav-item ">
                <a class="nav-link" href="/HenryBuron_About" style="font-size: 24px; font-weight: bold;">About</a>
            </li>
            <!-- Add more nav links here with the same structure for their active state -->
        </ul>
        <!-- End Menu -->

        <script src="/assets/js/lunr.js"></script>


<style>
    .lunrsearchresult .title {color: #d9230f;}
    .lunrsearchresult .url {color: silver;}
    .lunrsearchresult a {display: block; color: #777;}
    .lunrsearchresult a:hover, .lunrsearchresult a:focus {text-decoration: none;}
    .lunrsearchresult a:hover .title {text-decoration: underline;}
</style>


<form class="bd-search" onSubmit="return lunr_search(document.getElementById('lunrsearch').value);">
    <input type="text" class="form-control text-small launch-modal-search" id="lunrsearch" name="q" maxlength="255" value="" placeholder="Type and enter..."/>
</form>

<div id="lunrsearchresults">
    <ul></ul>
</div>

<script src="/assets/js/lunrsearchengine.js"></script>

    </div>

    </div>
</nav>
<!-- End Navigation
================================================== -->

<div class="site-content">

<div class="container">

<!-- Site Title
================================================== -->
<div class="mainheading">
    <h1 class="sitetitle">Henry Buron</h1>
    <p class="lead">
        Master's in Robotics at Northwestern University
    </p>
</div>

<!-- Content
================================================== -->
<div class="main-content">
    <!-- Begin Article
================================================== -->
<div class="container">
    <div class="row">

        <!-- Post -->
        

        <div class="col-md-9 flex-first flex-md-unordered">
            <div class="mainheading">

                <!-- Author Box -->
                

                <!-- Post Title -->
                <h1 class="posttitle">Polyglotbot: A 7 DoF Robot Arm that Writes Translated Text and Speech</h1>

            </div>

            <!-- Adsense if enabled from _config.yml (change your pub id and slot) -->
            
            <!-- End Adsense -->

            <!-- Post Content -->
            <div class="article-post" style="color: white; font-size: 22px;">
                <!-- Toc if any -->
                
                <!-- End Toc -->
                <p>ROS2, Python, MoveIt2, Motion Planning</p>

<iframe width="90%" height="441" src="https://www.youtube.com/embed/f93vAm1NstA?si=q7lfAgRUdSKHukga" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen=""></iframe>

<h2 id="overview">Overview</h2>

<p><strong>Goal</strong>: Develop a ROS2 package that allows a 7 DoF Framka Emika Panda robotic arm to write translated text and speech on a whiteboard.</p>

<p><strong>Team</strong>: Allen Liu, Kassidy Shedd, Megan Black, Damien Koh</p>

<p><strong>GitHub</strong>: <a href="https://github.com/ME495-EmbeddedSystems/final-project-dkoh555">https://github.com/ME495-EmbeddedSystems/final-project-dkoh555</a></p>

<p>My primary responsibilities for this project included:</p>
<ul>
  <li>Creating the <code class="language-plaintext highlighter-rouge">apriltags</code>  and <code class="language-plaintext highlighter-rouge">speech</code> packages</li>
  <li>Working with the MoveIt2 package to help convert waypoints to movement</li>
</ul>

<div style="background-color: white; height: 1px;"></div>

<p><code class="language-plaintext highlighter-rouge">apriltags</code> package</p>

<p>The purpose of this package is to localize the AprilTags on the whiteboard, transform their 3D-locations into the robot’s base frame (panda_link0), and publish these coordinates so they can be accessed by the node used for movement.</p>

<p>The <em>GetAprilTags</em> node in the package creates a static transformation that links the camera to robot base, looks up transforms between the tags and camera, constructs transformation matrices from Quaternions, extracts the coordinate values, and publishes them using a custom message type.</p>

<p>In the image below, the AprilTags have been localized and transformed into the robot’s frame.
<img src="/assets/images/localize_tags.png" alt="Localize Tags" /></p>

<div style="background-color: white; height: 1px;"></div>

<p><code class="language-plaintext highlighter-rouge">speech</code> package</p>

<p>The purpose of this package is to provide the speech-to-text functionality, as an alternative to the default text-to-text.</p>

<p>The node, <em>ListenSpeech</em>, is triggered by a service call. The package makes use of PyAudio and the speech_recognition library. By default, it translates the spoken language to English, but this can be changed with a different language code.</p>

<p>The service call activates the <em>LISTENING</em> state, which listens, then continues the node’s pipeline in the <em>RECOGNIZING</em> state.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre><span class="k">if</span> <span class="bp">self</span><span class="p">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">State</span><span class="p">.</span><span class="n">LISTENING</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">sr</span><span class="p">.</span><span class="n">Microphone</span><span class="p">(</span><span class="n">device_index</span><span class="o">=</span><span class="bp">self</span><span class="p">.</span><span class="n">index</span><span class="p">)</span> <span class="k">as</span> <span class="n">source</span><span class="p">:</span> <span class="c1"># detects presence of external microphone
</span>                <span class="bp">self</span><span class="p">.</span><span class="n">get_logger</span><span class="p">().</span><span class="n">info</span><span class="p">(</span><span class="s">"Say something..."</span><span class="p">)</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">recognizer</span><span class="p">.</span><span class="n">adjust_for_ambient_noise</span><span class="p">(</span><span class="n">source</span><span class="p">)</span> <span class="c1"># adjusts for ambient noise
</span>                <span class="bp">self</span><span class="p">.</span><span class="n">audio</span> <span class="o">=</span> <span class="bp">self</span><span class="p">.</span><span class="n">recognizer</span><span class="p">.</span><span class="n">listen</span><span class="p">(</span><span class="n">source</span><span class="p">)</span> <span class="c1"># by default, it listens until it detects a pause
</span>
            <span class="bp">self</span><span class="p">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">State</span><span class="p">.</span><span class="n">RECOGNIZING</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<div style="background-color: white; height: 1px;"></div>

<p><strong>Waypoints to Movement</strong></p>

<p>Each letter that the robot writes begins as a series of waypoints (2D-coordinates) that must be converted into physical movement by the robot arm. To do this, we created a custom <em>move_robot</em> Python API to plan and execute paths using the MoveIt2 MoveGroup and ExecuteTrajectory Action Clients, respectively. We make use of MoveIt2’s <em>compute_cartesian_path</em> service to follow a smooth and stable path.</p>

<p>See the <em>move_robot</em> API: <a href="https://github.com/henryburon/move-robot/tree/main/move_robot"><em>move_robot</em></a></p>

<p>The API plans collision-free paths and allows the user to send the end-effector to a desired configuration with code as simple as:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="bp">self</span><span class="p">.</span><span class="n">comm_count</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># self.comm_count is incremented after each successful execution of a position command
</span><span class="bp">self</span><span class="p">.</span><span class="n">pos_list</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)]</span> <span class="c1"># desired location
</span><span class="bp">self</span><span class="p">.</span><span class="n">ori_list</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">Quaternion</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">w</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)]</span> <span class="c1"># desired orientation
</span><span class="bp">self</span><span class="p">.</span><span class="n">robot</span><span class="p">.</span><span class="n">find_and_execute</span><span class="p">(</span>
                    <span class="n">point</span><span class="o">=</span><span class="bp">self</span><span class="p">.</span><span class="n">pos_list</span><span class="p">[</span><span class="bp">self</span><span class="p">.</span><span class="n">comm_count</span><span class="p">],</span> 
                    <span class="n">quat</span><span class="o">=</span><span class="bp">self</span><span class="p">.</span><span class="n">ori_list</span><span class="p">[</span><span class="bp">self</span><span class="p">.</span><span class="n">comm_count</span><span class="p">],)</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<div style="background-color: white; height: 1px;"></div>

<p><strong>How it Works</strong>:</p>

<ol>
  <li><strong>Calibrate</strong>
    <ul>
      <li>The robot uses an Intel Realsense camera to acquire the location of three AprilTags, which, together, are used to constrain the plane of the whiteboard.</li>
      <li>The distance and orientation of the whiteboard is made public through a custom message type on a ROS2 topic.</li>
      <li>Using the known transformation between the camera link and the robot arm’s base link, the updated configuration (Pose) of the whiteboard is extrapolated into the frame of reference of the end-effector and is used to position the pen when writing.</li>
    </ul>
  </li>
  <li><strong>Detect Text</strong>
    <ul>
      <li>By default, the robot then enters the “Detecting” state, in which it waits for a human to enter the frame and start writing on the whiteboard.</li>
      <li>Using the YOLOv8 deep learning model, the robot recognizes once a human has entered the frame and then left, after which the next step commences.</li>
      <li>The robot then uses the PaddleOCR library to detect the text written on the whiteboard and pass it along, without any processing, as a string. The desired language is written on the whiteboard as a short language code above the unknown word(s) (e.g. “en” for English).</li>
      <li>Alternatively, instead of writing a word on the whiteboard, the user could call the <em>speech</em> service which activates the microphone as an input. The user then simply speaks out loud, and their word(s) are passed along as a string from there. By default, the desired language for speech is set to English.</li>
    </ul>
  </li>
  <li><strong>Translate Text</strong>
    <ul>
      <li>The next stage in the pipeline is the <em>translator</em> node which takes in both the desired language and the string of the unknown word(s).</li>
      <li>The translation node uses the Google Translate API and can translate to and from 50+ languages.</li>
      <li>This step outputs a fully-translated string of text.</li>
    </ul>
  </li>
  <li><strong>Text to Waypoints</strong>
    <ul>
      <li>The <em>string2waypoints</em> node uses matplotlib to convert each character to a series of waypoints–passed along as a series of <em>Point</em> messages–which can then be followed by the robot arm.</li>
    </ul>
  </li>
  <li><strong>Waypoints to Movement</strong>
    <ul>
      <li>Finally, the robot uses the <em>write_letters</em> package to convert the waypoints to movement and draw the letters on the board.</li>
      <li>This package makes use of our custom <em>move_robot</em> Python API to plan and execute robot arm paths using the MoveIt2 MoveGroup and ExecuteTrajectory Action Clients, respectively.</li>
      <li>We make use of MoveIt2’s <em>compute_cartesian_path</em> service so as to follow a more direct and stable path when writing the letters, as opposed to <em>compute_ik</em>.</li>
    </ul>
  </li>
</ol>

<p><img src="/assets/images/the_robot_is_cool.jpeg" alt="The Robot Is Cool" /></p>

            </div>

            <!-- Rating -->
            

            <!-- Post Date -->
            <p>
            <small>
                <span class="post-date"><time class="post-date" datetime="2023-12-05">05 Dec 2023</time></span>           
                
                </small>
            </p>

            <!-- Post Categories -->
            <div class="after-post-cats">
                <ul class="tags mb-4">
                    
                    
                    <li>
                        <a class="smoothscroll" href="/categories#Motion-Planning">Motion Planning</a>
                    </li>
                    
                    <li>
                        <a class="smoothscroll" href="/categories#MoveIt2">MoveIt2</a>
                    </li>
                    
                    <li>
                        <a class="smoothscroll" href="/categories#Python">Python</a>
                    </li>
                    
                    <li>
                        <a class="smoothscroll" href="/categories#ROS2">ROS2</a>
                    </li>
                    
                </ul>
            </div>
            <!-- End Categories -->

            <!-- Post Tags -->
            <div class="after-post-tags">
                <ul class="tags">
                    
                    
                </ul>
            </div>
            <!-- End Tags -->

            <!-- Prev/Next -->
            <div class="row PageNavigation d-flex justify-content-between font-weight-bold">
            
            <a class="prev d-block col-md-6" href="/mobile-manipulation/"> &laquo; KUKA youBot Mobile Manipulation</a>
            
            
            <a class="next d-block col-md-6 text-lg-right" href="/turtlebot_slam/">Extended Kalman Filter SLAM from Scratch &raquo; </a>
            
            <div class="clearfix"></div>
            </div>
            <!-- End Categories -->

        </div>
        <!-- End Post -->

    </div>
</div>
<!-- End Article
================================================== -->

<!-- Review with LD-JSON, adapt it for your needs if you like, but make sure you test the generated HTML source code first: 
https://search.google.com/structured-data/testing-tool/u/0/
================================================== -->

</div>

<!-- Categories Jumbotron
================================================== -->
<div class="jumbotron fortags">
	<div class="d-md-flex h-100">
		<div class="col-md-4 transpdark align-self-center text-center h-100">
            <div class="d-md-flex align-items-center justify-content-center h-100">
                <h2 class="d-md-block align-self-center py-1 font-weight-light">Explore <span class="d-none d-md-inline">→</span></h2>
            </div>
		</div>
		<div class="col-md-8 p-5 align-self-center text-center">
            
            
                
                    <a class="mt-1 mb-1" href="/categories#Path-Planning">Path Planning (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Python">Python (6)</a>
                
                    <a class="mt-1 mb-1" href="/categories#RRT">RRT (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#ArduPilot">ArduPilot (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Electronics">Electronics (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Autonomous-Systems">Autonomous Systems (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#OpenCV">OpenCV (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Transforms">Transforms (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Machine-Learning">Machine Learning (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Image-Processing">Image Processing (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Robotic-Manipulation">Robotic Manipulation (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#CoppeliaSim">CoppeliaSim (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#ROS2">ROS2 (3)</a>
                
                    <a class="mt-1 mb-1" href="/categories#MoveIt2">MoveIt2 (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Motion-Planning">Motion Planning (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#C++">C++ (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Unit-Testing">Unit Testing (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#CMake">CMake (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Embedded-Systems">Embedded Systems (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Multi-Robot-System">Multi-Robot System (1)</a>
                
                    <a class="mt-1 mb-1" href="/categories#Autonomous-Flight">Autonomous Flight (1)</a>
                
            
            
		</div>
	</div>
</div>

<!-- Begin Footer
================================================== -->
<footer class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-sm-6 text-center text-lg-left">
                Copyright © 2024 Henry Buron 
            </div>
            <div class="col-md-6 col-sm-6 text-center text-lg-right">    
                
            </div>
        </div>
    </div>
</footer>
<!-- End Footer
================================================== -->

</div> <!-- /.site-content -->

<!-- Scripts
================================================== -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>

<script src="/assets/js/mediumish.js"></script>



<script src="/assets/js/ie10-viewport-bug-workaround.js"></script> 


<script id="dsq-count-scr" src="//.disqus.com/count.js"></script>


</body>
</html>
